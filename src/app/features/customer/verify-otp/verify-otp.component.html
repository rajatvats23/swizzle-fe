<div class="min-h-screen bg-background-light flex items-center justify-center p-4 font-display">

  <!-- Blobs -->
  <div class="absolute -top-12 -right-12 w-48 h-48 bg-primary/5 rounded-full blur-3xl pointer-events-none"></div>
  <div class="absolute -bottom-12 -left-12 w-48 h-48 bg-primary/5 rounded-full blur-3xl pointer-events-none"></div>

  <div class="relative w-full max-w-[400px] min-h-[600px] bg-white rounded-2xl shadow-2xl overflow-hidden flex flex-col">

    <!-- Top Bar -->
    <div class="flex items-center px-4 py-4 border-b border-slate-100">
      <button (click)="goBack()" class="flex items-center justify-center w-10 h-10 rounded-full hover:bg-slate-100 transition-colors">
        <span class="material-symbols-outlined text-slate-700">arrow_back</span>
      </button>
      <h2 class="flex-1 text-center text-base font-bold text-slate-900">Verification</h2>
      <div class="w-10"></div>
    </div>

    <!-- Progress -->
    <div class="px-6 pt-5 pb-1">
      <div class="flex justify-between items-end mb-2">
        <span class="text-primary font-bold text-sm">Step 2 of 3</span>
        <span class="text-slate-400 text-xs font-medium">66% Complete</span>
      </div>
      <div class="w-full bg-slate-100 h-1.5 rounded-full overflow-hidden">
        <div class="bg-primary h-full rounded-full" style="width:66%"></div>
      </div>
    </div>

    <!-- Content -->
    <div class="flex-1 px-6 pt-6">
      <h1 class="text-slate-900 text-2xl font-extrabold tracking-tight mb-1">Verify OTP</h1>
      <p class="text-slate-500 text-sm mb-6">
        We've sent a 6-digit code to
        <span class="text-slate-800 font-semibold">+91 {{ phoneNumber() }}</span>
      </p>

      <!-- Error -->
      @if (error()) {
        <div class="flex items-center gap-2 bg-red-50 border border-red-100 text-red-600 text-sm rounded-xl px-4 py-3 mb-5">
          <span class="material-symbols-outlined text-[18px]">error</span>
          <span>{{ error() }}</span>
        </div>
      }

      <!-- 6-Box OTP -->
      <div class="flex justify-between gap-2 mb-8">
        @for (i of [0,1,2,3,4,5]; track i) {
          <input
            type="number"
            inputmode="numeric"
            maxlength="1"
            [id]="'otp-' + i"
            [value]="otp()[i]"
            (input)="onBoxInput($event, i)"
            (keydown)="onBoxKeydown($event, i)"
            (paste)="onPaste($event)"
            placeholder="–"
            class="w-12 h-14 text-center text-2xl font-bold border-2 border-slate-200 rounded-xl focus:border-primary focus:outline-none bg-white text-slate-900 transition-colors appearance-none [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none"
          />
        }
      </div>

      <!-- Resend -->
      <div class="text-center mb-2">
        <p class="text-slate-500 text-sm mb-1">Didn't receive the code?</p>
        @if (!canResend()) {
          <span class="text-slate-400 text-sm font-medium">
            Resend OTP in <span class="font-mono text-primary">{{ resendTimer() }}s</span>
          </span>
        } @else {
          <button (click)="resendOtp()" class="text-primary font-bold text-sm hover:underline flex items-center justify-center gap-1 mx-auto">
            <span class="material-symbols-outlined text-[16px]">refresh</span>
            Resend OTP
          </button>
        }
      </div>
    </div>

    <!-- Footer -->
    <div class="px-6 pb-6 mt-auto space-y-3">
      <button
        (click)="verifyOtp()"
        [disabled]="loading() || otp().length !== 6"
        class="w-full bg-primary text-white font-bold py-4 rounded-xl shadow-lg shadow-primary/20 flex items-center justify-center gap-2 active:scale-[0.98] transition-all disabled:opacity-50"
      >
        @if (loading()) {
          <span class="material-symbols-outlined text-[20px] animate-spin">progress_activity</span>
          <span>Verifying…</span>
        } @else {
          <span>Verify &amp; Continue</span>
          <span class="material-symbols-outlined text-[20px]">arrow_forward</span>
        }
      </button>

      <!-- Subtle icon decoration -->
      <div class="flex justify-center opacity-10 pointer-events-none mt-4">
        <span class="material-symbols-outlined text-6xl text-primary">mark_email_read</span>
      </div>
    </div>

  </div>
</div>
